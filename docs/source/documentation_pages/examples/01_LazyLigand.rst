Example 01: LazyLigand
======================

This example demonstrates how to use the LazyLigand class to perform a single RESP calculation.


Learning Outcomes:
------------------

1) Learn how to use the LazyLigand class to perform a single RESP calculation to parametrize a ligand.
2) Learn how to list and execute stages in the pipeline.

Files 
-----
The files for this example can be found in the `LigandParameterization/ligandparam/examples/01_LazyLigand` directory of the source code.


Tutorial 
--------

To start with any of the premade recipes, you need to import the recipe from the module. Using the wild-card character will import
all the recipes available in the module, whereas, importing a specific recipe will only import that recipe.

.. literalinclude :: ../../../../examples/01_LazyLigand/param_thio.py
    :language: python
    :end-at: gaussian_scratch

The next step is to load the pdb file into the recipe of your choosing, and set various machine parameters. Full parameters that can be selected
are available in the documentation for the class (for instance, for LazyLigand, see :class:`ligandparam.module.LazyLigand`).

.. literalinclude :: ../../../../examples/01_LazyLigand/param_thio.py
    :language: python
    :end-before: # Set the pre-initialized stages
    :start-at: parametrize_ligand =

Note that here, we have chosen the bae_name file `thiophenol` and set the net charge to 0 using the *netcharge* parameter. If you have a charged ligand, you need to select the
proper net charge, as later when Gaussian runs it will need to know the net charge of the molecule. The *nproc* and *mem* parameters are used to set the 
number of processors and the memory to be used by Gaussian, respectively.

The next step is to select the pre-initialized stages for the LazyLigand class. This can be done using the *setup* method.

.. literalinclude :: ../../../../examples/01_LazyLigand/param_thio.py
    :language: python
    :start-at: parametrize_ligand.setup
    :end-at: parametrize_ligand.setup

The LazyLigand class has a number of stages that are pre-initialized. 

Roughly, these stages do the following:

1) Convert the pdb file to a mol2 and assign initial charges
2) Run Gaussian to assign resp charges
3) Write out lib/frcmod files for the ligand


To list the stages out to the user, you can use the *list_stages* method.

.. literalinclude :: ../../../../examples/01_LazyLigand/param_thio.py
    :language: python
    :start-at: parametrize_ligand.list_stages
    :end-at: parametrize_ligand.list_stages

Finally, to execute the stages in order, you can use the *execute* method. The *dry_run* parameter is used to test the pipeline
 without actually creating any files. This is useful to check if the pipeline is working as expected; however, it has limited functionality 
 as many stages depend on files generated by previous stages.


.. literalinclude :: ../../../../examples/01_LazyLigand/param_thio.py
    :language: python
    :start-at: parametrize_ligand.execute
    :end-at: parametrize_ligand.execute


This will run the pipeline in order, generating the necessary files for the ligand parameterization.

The output files will be generated in the same directory as the input pdb file, and will have the same name as the pdb file, but with different extensions.

These files are:

- thiophenol.resp.mol2 - The final mol2 file with the RESP charges.

- thiophenol.frcmod - The frcmod file for the ligand.

- thiophenol.off - The off(lib) parameter file for the ligand.



Full code
---------

.. literalinclude :: ../../../../examples/01_LazyLigand/param_thio.py
    :language: python